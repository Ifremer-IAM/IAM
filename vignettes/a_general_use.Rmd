---
title: "How to use IAM"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to use IAM}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


To use the IAM model, you first need to load it into R. If the package is not installed, this command will return an error. For installation advices, please refer to the README document or contact us.
```{r setup}
library(IAM)
```


# Data selection

## Importing dataset

IAM require a .xlsx file in input. The file format is complex and explained in the main manual document. <!-- Could be usefull to show some example about the construction of this file in another vignette. -->

Loading the file will return an `iamInput` class object containing 7 slots. These are constructed for the C++ function latter and you should not modify them by hand !

<!-- there is a need for a summary function !!! -->

```{r, include=FALSE}
# TODO  export the function into the package.
# simplified system from {readr} package.
# @param file Name of the file. Need to be in inst/extdata/ directory of the package
IAM_example <- function(file){
  system.file("extdata", file, package = "IAM", mustWork = TRUE)
}
# test basic :
fileIN <- IAM_example("IAM_MED_simpl.xlsx") # simplified with only 2 dyn and 2 static
file.exists(fileIN)
```


```{r}
fileIN <- IAM_example("IAM_MED_simpl.xlsx") # simplified with only 2 dyn and 2 static

file.exists(fileIN)

input <- IAM.input(fileIN = fileIN, t_init = 2020, nbStep = 5, folderFleet = NULL, desc = "Vignette example")
slotNames(input)
```

<!--
If the file has already been imported and exported as .txt files, it can be reimported with the same function.
-->

## Initialize arguments

`IAM.args()` use an `iamInput` class object and will open an interface to help the user input simulations caracteristics. 
This function will return an `iamArgs` class object. This object can be reused by the `IAM.args()` function to update it.

```{r, eval = FALSE}
# init args object
args <- IAM.args(input)

# update args object.
up_args <- IAM.args(args)
```


<!--
iamArgs object can be exported as .txt files and reloaded by this function

#
##importation des arguments
#impArg <- IAM.args("C:/Documents and Settings/mmerzere/Bureau/COST_R/IAMwd/expArgs/args.txt",
#                   "C:/Documents and Settings/mmerzere/Bureau/COST_R/IAMwd/expArgs/specific.txt",desc="My args")
#
-->

# Simulate

`IAM.model()` function allow to run a simulation according to what is define in corresponding <!-- # TODO : really corresponding ?--> `iamArgs` and `iamInput` objects.
```{r, eval = FALSE}
mod <- IAM20::IAM.model(args, input)
stripe <- IAM::IAM.model(args, input, verbose = TRUE)
```


```{r}
all.equal(mod@arguments, stripe@arguments)
all.equal(mod@specific, stripe@specific)
all.equal(mod@outputSp, stripe@outputSp)
all.equal(mod@output, stripe@output)
```





