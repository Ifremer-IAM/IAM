<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="IAM">
<title>Utilisation IAM dans R (fr) • IAM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Utilisation IAM dans R (fr)">
<meta property="og:description" content="IAM">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">IAM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-notices">Notices</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-notices">
    <a class="external-link dropdown-item" href="https://gitlab.ifremer.fr/iam/iam/-/raw/main/inst/notice/Notice_IAM.pdf?inline=false">
      <span class="fa fa-download"></span>
       
      Notice pdf (fr)
    </a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/use_IAM.html">Utilisation IAM dans R (fr)</a>
    <a class="dropdown-item" href="../articles/Target_Fmsy.html">Scénarios TAC, quotas et transition Fmsy</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://gitlab.ifremer.fr/iam/iam" aria-label="gitlab">
    <span class="fab fa fab fa-gitlab fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="use_IAM_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Utilisation IAM dans R (fr)</h1>
            
      
      <small class="dont-index">Source: <a href="https://gitlab.ifremer.fr/iam/iamvignettes/use_IAM.Rmd" class="external-link"><code>vignettes/use_IAM.Rmd</code></a></small>
      <div class="d-none name"><code>use_IAM.Rmd</code></div>
    </div>

    
    
<p>Le modèle bio-économique IAM a été développé dans l’optique d’être utilisable sous un environnement R <span class="citation">(R Core Team 2021)</span>. L’outil est ainsi accessible par l’intermédiaire d’un package R intégrant un ensemble de méthodes couvrant toutes les étapes de la modélisation, de la phase de paramétrage à la restitution des sorties du modèle. Cette vignette traite des possibilités offertes par les outils du package, et de la manière dont on peut les utiliser pour procéder de manière relativement simple et rapide à des simulations et aux traitements des résultats.</p>
<div class="section level2">
<h2 id="choix-dimplémentation">Choix d’implémentation<a class="anchor" aria-label="anchor" href="#choix-dimpl%C3%A9mentation"></a>
</h2>
<p>Les choix d’implémentation du modèle IAM ont découlé d’exigences techniques fixées dans le but de maximiser la pérennité et la fonctionnalité du modèle. Elles portaient à la fois sur l’aspect purement technique du programme (rapidité, qualité des algorithmes,…), sur sa flexibilité (généricité et robustesse face à la multiplicité des configurations d’inputs prises en charge, diversité des scénarios proposés, choix des bases de données d’entrée, diversité des outils satellites au modèle proprement dit,…) ou encore sur son accessibilité (simplicité d’utilisation, logiciels gratuits et facilement téléchargeables, installation simple, méthodes à la fois génériques et paramétrables,…).</p>
<p>Le langage <code>R</code> réunit une grande partie de ces caractéristiques. C’est un logiciel libre et gratuit de traitement statistique, largement répandu à l’heure actuelle au sein de la communauté halieutique et qui offre l’avantage d’être relativement simple d’emploi. Il représente un environnement adéquat pour gérer des objets de paramétrage (notamment multidimensionnels, comme le sont ceux du modèle bio-économique). De surcroît, les sorties exportées en tant qu’objets <code>R</code> peuvent bénéficier des nombreuses fonctionnalités proposées par le logiciel (sorties graphiques, traitements statistiques,…).</p>
<p>Toutefois, il est apparu que le modèle deviendrait très rapidement exigeant en terme de temps calcul (algorithmes d’optimisation, beaucoup de variables, beaucoup de dimensions,…) et que l’utilisateur trouverait là la limite des possibilités offertes par <code>R</code>. La solution la plus évidente était de programmer le cœur du modèle en <code>C++</code>, et de laisser <code>R</code> piloter les routines, se contentant ainsi de gérer le paramétrage et le traitement des sorties. Ainsi, le modèle serait aussi simple d’utilisation que possible, sans toutefois que cela se fasse au détriment de ses performances et de sa flexibilité.</p>
</div>
<div class="section level2">
<h2 id="le-package-iam-version-2-0-0">Le package IAM (version 2.0.0)<a class="anchor" aria-label="anchor" href="#le-package-iam-version-2-0-0"></a>
</h2>
<p>Ce qui suit va être une description par l’exemple des outils contenus dans la version 2.0.0 du package IAM. Il faut garder à l’esprit que ce package étant encore en cours de développement, certains des descriptifs présentés ici pourront devenir obsolètes dans les prochaines versions. Ajoutons que toute cette partie suppose une connaissance minimale du logiciel <code>R</code> (installation d’un package, utilisation de la fenêtre de commande,…).</p>
<div class="section level3">
<h3 id="installation-et-chargement-du-package">Installation et chargement du package<a class="anchor" aria-label="anchor" href="#installation-et-chargement-du-package"></a>
</h3>
<p>L’installation du package IAM se fait de la même manière que tout autre package du CRAN, à la différence que le dépôt doit être précisé. D’autres méthodes d’installations sont développées dans le <a href="https://gitlab.ifremer.fr/iam/iam/-/blob/main/README.md" class="external-link">README.md</a> du gitlab hébergeant le code source. Ces méthodes peuvent être utiles dans le cas d’installation de versions précédentes ou en cours de développement actif.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"IAM"</span>, repos <span class="op">=</span> <span class="st">"https://ifremer-iam.r-universe.dev"</span><span class="op">)</span></code></pre></div>
<p>Après avoir installé le package IAM, l’instruction suivante va charger le package en session, donnant accès à tous les outils de modélisation :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.ifremer.fr/iam/iam" class="external-link">IAM</a></span><span class="op">)</span></code></pre></div>
<p>On peut vérifier que le package est bien installé en tapant :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">IAM</span><span class="op">)</span> <span class="co"># alternative : ?IAM</span>
<span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span>package <span class="op">=</span> <span class="va">IAM</span><span class="op">)</span></code></pre></div>
<p>Ces commandes permettend d’accéder à l’aide du package, avec une aide détaillée pour chaque fonction. S’y ajoute également l’ensemble des méthodes et des classes d’objets dorénavant accessibles.</p>
</div>
<div class="section level3">
<h3 id="importation-des-paramètres-iam-input">Importation des paramètres (<code>IAM.input</code>)<a class="anchor" aria-label="anchor" href="#importation-des-param%C3%A8tres-iam-input"></a>
</h3>
<!-- ::: {#simple_example .greeting .message style="color: red;"} -->
<!-- avoir un example simple sans SS3 et introduire le SS3 dans une autre vignette. -->
<!-- ::: -->
<p>La package intègre un fichier exemple de paramétrage qui va permettre d’illustrer le fonctionnement des procédures d’importation. <!-- Ce fichier doit se trouver dans le répertoire "IAM" du dossier "R/R-version/library". --> La fonction <code><a href="../reference/IAM_example.html">IAM_example()</a></code> renvoie le chemin du fichier d’exemple choisis dans le package IAM. Il s’agit de données brutes au format <code>.xlsx</code> ou <code>.RData</code>.</p>
<p>Ces données brutes sont constituées d’un fichier <code>.xlsx</code>, d’une fichier <code>.RData</code> contenant des informations pour une espèce SS3 ainsi qu’un dossier <code>fleet/</code> contenant les informations sur les structures de coûts de plusieurs flotilles types.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/IAM_example.html">IAM_example</a></span><span class="op">(</span><span class="st">"inputFile.xlsx"</span><span class="op">)</span> <span class="co"># attention ici il s'agit d'un fichier brut.</span>
<span class="co"># ce fichier est accessible a cette adresse pour être lu et modifié au besoin</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="../reference/IAM_example.html">IAM_example</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="co"># listes des fichiers accessibles avec IAM_example()</span></code></pre></div>
<p>Le package contient également des objets intermédiaires issus des différentes fonctions. On peut accéder à la liste des fichiers d’exemples et leur documentation avec les commandes suivantes :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"IAM"</span><span class="op">)</span></code></pre></div>
<p>La méthode <code><a href="../reference/IAM.input-methods.html">IAM.input()</a></code> sert à l’importation des paramètres d’entrée bruts du modèle, et retourne un objet de classe <code>iamInput</code> regroupant de manière organisée toute ces données. Elle prend pour argument principal le chemin du fichier <code>.xlsx</code> à importer, complété par <code>t_init</code> l’instant initial, et <code>nbStep</code> le nombre de pas de temps désiré pour la simulation.</p>
<p>Dans le cadre de cet exemple, il faut cependant noter quelques modifications. En effet ici les flotilles ne sont pas comprises dans le fichier <code>.xlsx</code> et sont donc à aller chercher dans un dossier flottille avec l’argument <code>folderFleet</code>.</p>
<p>De même, une espèce décrite dans le fichier de paramètrage utilise un modèle de dynamique dit <em>SS3</em>, et les informations sont donc introduites à ce moment là. Il s’agit de mortalité définies par saisons.</p>
<p>On procède alors à l’importation de la manière suivante (<em>attention, cela peut prendre quelques secondes selon le nombre de flottilles</em>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="../reference/IAM_example.html">IAM_example</a></span><span class="op">(</span><span class="st">"IAM_SS3_2009.RData"</span><span class="op">)</span><span class="op">)</span>

<span class="va">IAM_input_2009</span> <span class="op">&lt;-</span> <span class="fu">IAM</span><span class="fu">::</span><span class="fu"><a href="../reference/IAM.input-methods.html">IAM.input</a></span><span class="op">(</span>
  fileIN <span class="op">=</span> <span class="fu"><a href="../reference/IAM_example.html">IAM_example</a></span><span class="op">(</span><span class="st">"inputFile.xlsx"</span><span class="op">)</span>,
  t_init <span class="op">=</span> <span class="fl">2009</span>, nbStep <span class="op">=</span> <span class="fl">12</span>, folderFleet <span class="op">=</span> <span class="fu"><a href="../reference/IAM_example.html">IAM_example</a></span><span class="op">(</span><span class="st">"fleets"</span><span class="op">)</span>,
  <span class="co"># elements </span>
  Fq_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFq_i</span><span class="op">)</span>, iniFq_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFq_i</span><span class="op">)</span>,
  Fq_fmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFq_fmi</span><span class="op">)</span>, iniFq_fmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFq_fmi</span><span class="op">)</span>,
  FqLwt_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqLwt_i</span><span class="op">)</span>, iniFqLwt_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqLwt_i</span><span class="op">)</span>,
  FqLwt_fmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqLwt_fmi</span><span class="op">)</span>, iniFqLwt_fmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqLwt_fmi</span><span class="op">)</span>,
  FqDwt_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqDwt_i</span><span class="op">)</span>, iniFqDwt_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqDwt_i</span><span class="op">)</span>,
  FqDwt_fmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqDwt_fmi</span><span class="op">)</span>, iniFqDwt_fmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniFqDwt_fmi</span><span class="op">)</span>,
  Nt0s1q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">Nt0s1q</span><span class="op">)</span>, Ni0q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">Ni0q</span><span class="op">)</span>,
  iniNt0q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">iniNt0q</span><span class="op">)</span>, matwt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DAR <span class="op">=</span> <span class="va">mat_morphage</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>L’objet résultant (ici <code>IAM_input_2009</code>) de classe <code>iamInput</code> possède une structure fixe spécifique, composée d’éléments appelés “slots” et que l’on peut distinguer de cette façon :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slotNames</span><span class="op">(</span><span class="va">IAM_input_2009</span><span class="op">)</span>
<span class="co">#&gt; [1] "desc"         "specific"     "historical"   "input"        "scenario"    </span>
<span class="co">#&gt; [6] "stochastic"   "optimization"</span></code></pre></div>
<p>Le slot “desc” est un simple descripteur permettant de caractériser l’objet ; c’est un paramètre optionnel de la fonction <code>IAM.input</code>. Le slot “specific” est constitué des descriptifs des dimensions du modèle qui vont conditionner la structure des variables. Le slot “historical” regroupe les données antérieures à l’instant initial <code>t_init</code>. Les slots “scenario” et “stochastic” intègrent les paramètres définis dans les feuillets correspondants. Enfin, le slot principal “input” rassemble les données initiales injectées dans le modèle. Il est composé d’un élément “Fleet” et d’un élément par espèce modélisée, ces derniers possédant la même structure. Au final, ce slot rassemble toutes les informations renseignées dans les feuillets “Stock”, “Flottille” et “Market”, ainsi que les matrices “fm”, “mm” et “icat”. Voici quelques exemples permettant d’accéder aux données de cet objet (l’accès aux slots se fait par <code>objet@slot</code>, l’accès aux éléments d’un slot par <code>slot$élément</code>) :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_input_2009</span><span class="op">@</span><span class="va">specific</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Species"   "StaticSpp" "AllSpp"    "Fleet"     "Metier"    "MetierEco"</span>
<span class="co">#&gt;  [7] "Ages"      "Cat"       "t_init"    "NbSteps"   "times"     "Q"        </span>
<span class="co">#&gt; [13] "S"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_input_2009</span><span class="op">@</span><span class="va">input</span><span class="op">)</span>
<span class="co">#&gt;  [1] "ARC"   "COR"   "DAR"   "GAR"   "GLY"   "HER"   "MAH"   "DOR"   "PAV"  </span>
<span class="co">#&gt; [10] "INO"   "TUL"   "PAM"   "MON"   "OED"   "HAY"   "FET"   "RHO"   "IPH"  </span>
<span class="co">#&gt; [19] "THY"   "OCH"   "VAU"   "ZZZ"   "Fleet"</span>
<span class="va">IAM_input_2009</span><span class="op">@</span><span class="va">input</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">wStock_i</span>
<span class="co">#&gt;     2     3     4     5     6     7   +gp </span>
<span class="co">#&gt; 0.200 0.252 0.302 0.373 0.394 0.405 0.555 </span>
<span class="co">#&gt; attr(,"DimCst")</span>
<span class="co">#&gt; [1] 0 0 7 0</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">IAM_input_2009</span><span class="op">@</span><span class="va">input</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">wStock_i</span><span class="op">)</span><span class="op">$</span><span class="va">DimCst</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="co">#&gt; [1] 7</span></code></pre></div>
<p>On peut ici noter l’attribut <code>DimCst</code> associé à la variable <code>wStock_i</code> . Chaque variable d’entrée insérée dans le slot <code>input</code> est affectée de cet attribut qui définit sa dimension : la première composante est la dimension flottille (0 signifie “pas de dimension”), la seconde est la dimension métier, la troisième est la dimension âge/catégorie, et la quatrième est la dimension temporelle. Dans l’exemple précédent, la variable se décline uniquement suivant la dimension “âge”, qui comprend pour l’espèce considérée 7 modalités. Cette attribution systématique permet au modèle de gérer les incompatibilités de dimensions entre les variables et de considérer plusieurs niveaux de définition pour une même variable.</p>
<p>Afin de simplifier l’utilisation de cette classe d’objets, une méthode <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> a été implémentée qui permet d’avoir un aperçu rapide :</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">IAM_input_2009</span><span class="op">)</span>
<span class="co">#&gt; My Input (IAM input) :</span>
<span class="co">#&gt; Simulation of 3 dynamic species, 19 static species and 7 fleet</span>
<span class="co">#&gt; Simulation start in 2009 and end in 2020 (12 steps)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -----------------------------------------</span>
<span class="co">#&gt; Dynamic Species | Model |     Ages (nb) |</span>
<span class="co">#&gt;             ARC |   XSA | 0 to +gp (21) |</span>
<span class="co">#&gt;             COR |   XSA | 2 to +gp ( 7) |</span>
<span class="co">#&gt;             DAR |   SS3 | 0 to +gp (16) |</span>
<span class="co">#&gt; -----------------------------------------</span>
<span class="co">#&gt;                   Fleet |    nbv   |</span>
<span class="co">#&gt;                    Alis |    24    |</span>
<span class="co">#&gt;                   Antea |    36    |</span>
<span class="co">#&gt;                Atalante |    15    |</span>
<span class="co">#&gt;                Haliotis |     5    |</span>
<span class="co">#&gt;         Marion_Dufresne |     9    |</span>
<span class="co">#&gt;            Pourquoi_pas |    18    |</span>
<span class="co">#&gt;                Thalassa |    60    |</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="constitution-des-arguments-iam-args">Constitution des arguments (IAM.args)<a class="anchor" aria-label="anchor" href="#constitution-des-arguments-iam-args"></a>
</h3>
<p>La méthode <code><a href="../reference/IAM.args-methods.html">IAM.args()</a></code> prend en paramètre un objet de classe <code>iamInput</code> et permet à l’utilisateur de fixer les caractéristiques de la simulation à opérer. Une interface de paramétrage s’affiche, et la validation renvoie un objet de classe <code>iamArgs</code> définissant les choix de pilotage du modèle.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IAM_argum_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.args-methods.html">IAM.args</a></span><span class="op">(</span><span class="va">IAM_input_2009</span><span class="op">)</span></code></pre></div>
<p>L’instruction va provoquer l’affichage d’une interface de paramétrage comportant 5 parties distinctes, chacune activant ou/et paramétrant une partie spécifique du modèle.</p>
<ul>
<li>
<p><strong>Recruitment</strong> : ce panneau de commande de type “tabbed notebook” permet de définir l’intégration de la variabilité dans le modèle en caractérisant le recrutement considéré dans la simulation. Il y a un onglet par espèce modélisée, chacun donnant accès à un choix de paramètres similaires. On pourra soit opter pour un recrutement généré par une relation stock-recrutement (activer alors le panneau en cochant “Stock Recrutement Model”, soit simuler un recrutement par tirage aléatoire dans un historique ou une loi de probabilité (cocher “StockSim”). Dans le premier cas, 5 paramètres sont à définir : le type de relation stock-recrutement, les paramètres de la relation (3 au maximum), et l’écart-type du bruit gaussien centré additionnel. Les relations sont décrites dans le tableau suivant :</p>
<table class="table">
<colgroup>
<col width="41%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Relation <br> Stock-Recrutement</th>
<th>Formulation <br> (<span class="math inline">\(\sigma\)</span> est le bruit gaussien)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td><span class="math inline">\(rec \sim a + \sigma\)</span></td>
</tr>
<tr class="even">
<td>Hockey Stick</td>
<td>si <span class="math inline">\(ssb \leq b\)</span> : <span class="math inline">\(rec \sim a \cdot ssb + \sigma\)</span> <br> sinon : <span class="math inline">\(rec \sim a \cdot b + \sigma\)</span>
</td>
</tr>
<tr class="odd">
<td>Beverton-Holt</td>
<td><span class="math inline">\(rec \sim \frac{ a \cdot ssb }{ b+ssb } + \sigma\)</span></td>
</tr>
<tr class="even">
<td>Ricker</td>
<td><span class="math inline">\(rec \sim a \cdot ssb \cdot e^{-b \cdot ssb} + \sigma\)</span></td>
</tr>
<tr class="odd">
<td>Shepherd</td>
<td><span class="math inline">\(rec \sim \frac{a \cdot ssb}{1+ (\frac{ssb}{b})^{c}} + \sigma\)</span></td>
</tr>
<tr class="even">
<td>Hockey Stick Quadratic</td>
<td>si <span class="math inline">\(ssb \leq b \cdot (1-c)\)</span> : <span class="math inline">\(rec \sim a \cdot ssb + \sigma\)</span> <br> si <span class="math inline">\(ssb \geq b \cdot (1+c)\)</span> : <span class="math inline">\(rec \sim a \cdot b + \sigma\)</span> <br> sinon : <span class="math inline">\(rec \sim a \cdot (ssb-\frac{( ssb - b \cdot (1-c))^{2}}{4 \cdot b \cdot c}) + \sigma\)</span>
</td>
</tr>
<tr class="odd">
<td>Hockey Stick Smooth</td>
<td>
<span class="math inline">\(rec \sim a \cdot \{ssb+ \sqrt{b^{2}+g}-\sqrt{(ssb-b)^{2}+g}\} + \sigma\)</span> avec <span class="math inline">\(g=0.001\)</span>
</td>
</tr>
</tbody>
</table>
<p>Il est possible d’annuler l’effet aléatoire en mettant la variable <span class="math inline">\(\sigma\)</span> à 0 (pas de variance, donc pas de variabilité). Précisons aussi que le recrutement s’exprime ici en nombre d’individus. La deuxième possibilité est de considérer le recrutement comme étant la réalisation d’un tirage aléatoire. Trois options sont alors envisageables :</p>
<ul>
<li><p>l’option 1 permet d’effectuer un tirage aléatoire dans l’historique de recrutement renseigné dans le feuillet “Stochasticité” du fichier de paramétrage, de manière indépendante (avec toutefois la pondération des probabilités spécifiée dans le fichier .xlsx).</p></li>
<li><p>l’option 2 est similaire à l’option 1, à la différence que le tirage ne sera pas indépendant. Pour chaque instant de la simulation, un seul tirage sera effectué pour toutes les espèces d’option 2 de recrutement pour déterminer un instant commun de l’historique à considérer. Notons que ce type de tirage impliquera seulement l’intersection des historiques pour les espèces concernées.</p></li>
<li><p>enfin, l’option 3 offre la possibilité de simuler le recrutement d’une espèce comme étant la réalisation d’une variable aléatoire de loi prédéterminée. Cette loi devra également être préalablement définie au sein du feuillet “Stochasticité” du fichier de paramètres.</p></li>
</ul>
<!--   | Hockey Stick Quadratic | si $ssb \leq b \cdot (1-c)$ : $rec \sim a \cdot ssb + \sigma$ <br> si $(b \cdot (1-c) < ssb < b \cdot (1+c)$ : $rec \sim a \cdot (ssb-\frac{( ssb - b \cdot (1-c))^{2}}{4 \cdot b \cdot c}) + \sigma$ <br> sinon : $rec \sim a \cdot b + \sigma$ | -->
</li>
<li><p><strong>Replicates</strong> : cette partie de l’interface permet de piloter le module de réplication. Pour activer/désactiver le module, cocher “activate”. Une fois le module activé, on peut paramétrer le nombre d’itérations à opérer, et choisir les variables en sortie. Cette option permet de limiter la taille des résultats de simulations qui peuvent devenir très volumineux si on multiplie inconsidérément le nombre de réplicats. Ce sera surtout le cas avec des variables à haut niveau de précision telles que <code>L_efmit</code>.</p></li>
<li><p><strong>Scenario</strong> : cette partie de l’interface permet de choisir le scénario à simuler, ce dernier étant caractérisé dans le feuillet “Scénario” du fichier de paramétrage. Pour activer/désactiver le module, cocher “activate”. Une fois le module activé, un scénario devra être sélectionné dans la liste (par définition, un scénario Statu Quo impliquera la désactivation du module). Afin de simplifier la mise en oeuvre des simulations et la gestion des sorties du modèle, on ne peut simuler qu’un seul scénario par envoi. A noter que ces scénarios sont plus difficiles à régler et demandent une bonne compréhension du modèle par rapport à l’utilisation de scénario par la partie “Management” du modèle et les scénarios de TAC.</p></li>
<li>
<p><strong>Management</strong> : le module “Management” peut être piloté intégralement par cette composante de l’interface pour les scénarios de TAC totaux. Un paramétrages de scénarios TAC par flottilles par exemple requiert de paramétrer la fonctions <code><a href="../reference/IAM.model-methods.html">IAM.model()</a></code> et fait l’objet d’une autre vignette. Tout comme pour les deux précédents contrôles, on activera le module en cochant “activate”, permettant ainsi l’accès aux champs de paramètres à renseigner suivants :</p>
<ul>
<li><p><em>Control</em> : permet de spécifier sur quelle variable d’effort agir afin d’atteindre les objectifs de gestion (pour le moment, laisse le choix entre le nombre de navires et le nombre de jours de mer).</p></li>
<li><p><em>Target</em> : variable sur laquelle porte les objectifs définis (3 options : atteinte du TAC, atteinte du Fbar, ou atteinte du TAC jusqu’à atteindre le Fbar, puis atteinte du Fbar).</p></li>
<li><p>Bouton <em>TAC/Fbar</em> : permet de renseigner les valeurs-objectifs de TAC et de Fbar pour l’espèce en question, sur l’intervalle de temps spécifié dans le paramétrage (une cellule par pas de temps). Il est conseillé de renseigner toutes les cellules de la table, en particulier pour une cible de type 3 (voir plus haut). La validation des valeurs s’opère à la fermeture de la fenêtre.</p></li>
<li><p><em>Species</em> : espèce sur laquelle porte la mesure de gestion (à choisir entre toutes les espèces modélisées)</p></li>
<li><p><em>Type</em> : multiplicatif ou additif.</p></li>
</ul>
<!-- **To explain !** --><ul>
<li><p><em>Delay</em> : délai d’application de la mesure de gestion (autrement dit, temps d’attente avant la mise en activation du module).</p></li>
<li><p><em>Update</em> : définit si l’ajustement s’opère à chaque fois sur les valeurs initiales des variables, ou sur les valeurs mises à jour. (NB: cette option n’impacte que sur la manière de quantifier les ajustements, et ne revêt de l’importance que dans des cadres d’utilisation très spécifiques).</p></li>
<li><p><em>Upper bound</em> / <em>Lower bound</em> : bornes de l’intervalle d’application de la procédure d’optimisation. Un intervalle restreint permet de maximiser le temps de calcul, mais fait prendre le risque de ne pas trouver de solution. Ces valeurs sont fortements dépendantes du type de gestion réglé. A utiliser avec précaution.</p></li>
<li><p>Bouton <em>Eff table</em> : effort maximum par flottille.</p></li>
</ul>
<!-- **To explain !** --><ul>
<li>Bouton <em>mFm table</em> : permet de renseigner les pondérations (décimales) par flottille utilisées durant le processus d’ajustement (une cellule par classe de flottille). Cette pondération permet de paramétrer la distribution d’effort concédée par chaque flottille afin d’atteindre l’objectif désiré. Un poids nul signifiera que la flottille en question conservera son effort initial. Un poids <em>p</em> signifiera que la variation de l’effort consentie par la flottille pour atteindre au final la valeur objectif sera <em>p</em> fois plus importante que celle des flottilles de poids unité (attention : tout ceci s’applique relativement au signe de variation global, qui peut être contrôlé par le biais des bornes supérieures et inférieures préalablement définies). Des poids de signes opposés peuvent être utilisés pour simuler des variations contraires selon les flottilles.</li>
</ul>
</li>
<li>
<p><strong>Economic</strong> : la dernière phase de paramétrisation concerne le modèle économique. La plupart des paramètres ici décrits peuvent être retrouvés dans le tableau de mise en équation du modèle économique en annexe de ce document.</p>
<ul>
<li>
<em>perscCalc</em> : Mode de calcul de la variable “coût du personnel”
<ul>
<li>0 : la variable est supposée constante</li>
<li>1 : relation linéaire avec <code>rtbs</code> et donnée <code>cshr</code> disponible</li>
<li>2 : relation linéaire avec <code>rtbs</code> et donnée <code>cshr</code> indisponible</li>
</ul>
</li>
<li>
<em>Discound rate (dr)</em> (Taux d’actualisation): Attention, le taux est en décimal, pas en pourcentage. Pour 4% d’actualisation, il faut rentrer la valeur 0,04. Ce taux d’actualisation va s’appliquer en sortie du modèle à une sélection de variables économiques principales, qui seront donc disponibles en 2 versions, actualisée et non actualisée. Ces variables sont les suivantes : <code>rtbs_f</code>, <code>cs_f</code>, <code>gva_f</code>, <code>gcf_f</code>, <code>ps_f</code> et <code>sts_f</code>.</li>
</ul>
</li>
</ul>
<p>Une fois la validation des arguments effectuée en cliquant sur “OK”, un objet de classe <code>iamArgs</code> est retourné, intégrant tous les arguments qui vont conditionner les processus mis en œuvre pendant la phase de simulation. Afin de simplifier l’utilisation de cette classe d’objets, une méthode <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> a été implémentée qui permet d’avoir un aperçu rapide</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span><span class="op">)</span>
<span class="co">#&gt; My Input (IAM argument) :</span>
<span class="co">#&gt; Simulation of 3 dynamic species, 19 static species and 7 fleet</span>
<span class="co">#&gt; Simulation start in 2009 and end in 2020 (12 steps)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =======================================================================================</span>
<span class="co">#&gt;   SR module  |               Stock Recruitment             |      Noise       | Proba |</span>
<span class="co">#&gt; ---------------------------------------------------------------------------------------</span>
<span class="co">#&gt;     Species  |    function  :  param A ; param B ; param C |  Type :    sd    |  Type |</span>
<span class="co">#&gt;    ARC (XSA) |          Mean 3.641e+07  0.00e+00  0.00e+00 |  Norm | 0.00e+00 |   .   |</span>
<span class="co">#&gt;    COR (XSA) |          Mean 1.893e+07  0.00e+00  0.00e+00 |  Norm | 0.00e+00 |   .   |</span>
<span class="co">#&gt;    DAR (SS3) | not activated 0.000e+00  0.00e+00  0.00e+00 |  Norm | 0.00e+00 |   .   |</span>
<span class="co">#&gt; ---------------------------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  The Gestion module is not active.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ============================================================</span>
<span class="co">#&gt; Economic : PerscCalc = 0 ; dr = 0.000 | No replicates      |</span>
<span class="co">#&gt; ------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  The Scenario module is not active.</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span><span class="op">@</span><span class="va">arguments</span><span class="op">)</span>
<span class="co">#&gt; [1] "Recruitment" "Replicates"  "Scenario"    "Gestion"     "Eco"</span></code></pre></div>
<p>On peut modifier l’objet déjà existant utilisant des fonctions spécifiques et les valeurs voulues. Mais ceci suggère une bonne connaissance de R et un risque non négligeable d’entamer la structure de l’objet. Par exemple, pour mettre en oeuvre la module Gestion et modifier les variables économiques :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modify Gestion</span>
<span class="va">IAM_argum_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.editArgs_Gest.html">IAM.editArgs_Gest</a></span><span class="op">(</span>
  <span class="va">IAM_argum_2009</span>, active <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="st">"Nb trips"</span>, target <span class="op">=</span> <span class="st">"Fbar"</span>,
  espece <span class="op">=</span> <span class="st">"DAR"</span>, type <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>
<span class="co"># Modify Eco</span>
<span class="va">IAM_argum_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.editArgs_Eco.html">IAM.editArgs_Eco</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span>, dr <span class="op">=</span> <span class="fl">0.04</span>, perscCalc <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Check if Gestion is active</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span><span class="op">)</span>
<span class="co">#&gt; My Input (IAM argument) :</span>
<span class="co">#&gt; Simulation of 3 dynamic species, 19 static species and 7 fleet</span>
<span class="co">#&gt; Simulation start in 2009 and end in 2020 (12 steps)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =======================================================================================</span>
<span class="co">#&gt;   SR module  |               Stock Recruitment             |      Noise       | Proba |</span>
<span class="co">#&gt; ---------------------------------------------------------------------------------------</span>
<span class="co">#&gt;     Species  |    function  :  param A ; param B ; param C |  Type :    sd    |  Type |</span>
<span class="co">#&gt;    ARC (XSA) |          Mean 3.641e+07  0.00e+00  0.00e+00 |  Norm | 0.00e+00 |   .   |</span>
<span class="co">#&gt;    COR (XSA) |          Mean 1.893e+07  0.00e+00  0.00e+00 |  Norm | 0.00e+00 |   .   |</span>
<span class="co">#&gt;    DAR (SS3) | not activated 0.000e+00  0.00e+00  0.00e+00 |  Norm | 0.00e+00 |   .   |</span>
<span class="co">#&gt; ---------------------------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =============================================================================</span>
<span class="co">#&gt;                      Gestion Module                                         | </span>
<span class="co">#&gt; -----------------------------------------------------------------------------</span>
<span class="co">#&gt;     Species  |   control  |    target | delay | typeG | update |   bounds   |</span>
<span class="co">#&gt;    DAR (SS3) |   Nb trips |      Fbar |    2  |   x   |   yes  |   0 :    0 |</span>
<span class="co">#&gt; -----------------------------------------------------------------------------</span>
<span class="co">#&gt;    TAC : NA NA NA NA NA NA NA NA NA NA NA NA </span>
<span class="co">#&gt;   FBAR : NA NA NA NA NA NA NA NA NA NA NA NA </span>
<span class="co">#&gt; ----------------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ============================================================</span>
<span class="co">#&gt; Economic : PerscCalc = 3 ; dr = 0.040 | No replicates      |</span>
<span class="co">#&gt; ------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  The Scenario module is not active.</span>
<span class="co"># Desactivate Gestion</span>
<span class="va">IAM_argum_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.editArgs_Gest.html">IAM.editArgs_Gest</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span>, active <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Mais la procédure la plus simple pour corriger un objet est de reprendre l’interface au stade de la validation, et d’effectuer directement les corrections. Pour cela, il suffit de rappeler la méthode <code><a href="../reference/IAM.args-methods.html">IAM.args()</a></code>, mais non plus affectée à un objet de paramétrage initial de classe <code>iamInput</code>, mais plutôt à l’objet qu’on désire modifier. On tape donc :</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IAM_argum_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.args-methods.html">IAM.args</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span><span class="op">)</span></code></pre></div>
<p>Une interface reprenant tous les arguments auparavant validés s’ouvre, permettant la correction, la validation, et ainsi la mise à jour de l’objet <code>IAM_argum_2009</code> en sortie.</p>
<!--

### Sauvegarde des deux types d'objets principaux (IAM.export)


Pour sauvegarder des objets iamInput et iamArgs, il est bien sûr possible de créer des environnements R (fichiers .Rdata) incluant ces objets. Mais s'affranchir d'un environnement R en sauvegardant ces données au format .txt peut se révéler problématique, notamment en raison de la structure relativement complexe de ces objets. La méthode IAM.export permet, comme son nom l'indique, d'effectuer cet export sous forme de fichiers .txt qui pourront être recomposés en objets R au moyen des procédures IAM.input et IAM.args. Cette méthode prend en entrée l'objet à exporter, ainsi que le chemin du répertoire dans lequel entreposer les fichiers générés.

Essayons par exemple d'exporter l'objet de paramétrage inp  dans un répertoire "folder" placé sur le disque C (cet exemple ne fonctionnera que si le répertoire existe effectivement) :


```r
IAM.export(inp,"C:/folder")
```

4 fichiers sont créés dans le dossier, chacun correspondant aux 4 slots fonctionnels de l'objet (le slot "historical" n'est pas conservé car il n'intervient pas dans le processus de modélisation ; de futurs développements devraient permettre de rectifier cette limitation) : "specific.txt", "input.txt", "scenario.txt" et "stochastic.txt". Le format de ces fichiers est relativement spécifique, et permet de retracer la structure imbriquée des slots. Sans rentrer dans les détails, les lignes commençant par list décrivent un niveau d'imbrication, et les lignes commençant par var énumèrent le contenu d'une variable.

Pour reconstituer l'objet R de paramétrage, on tape alors :


```r
inp2 <- IAM.input(fileIN = "C:/folder/input.txt",
            fileSPEC = "C:/folder/specific.txt",
                                     fileSCEN = "C:/folder/scenario.txt",
                                     fileSTOCH = "C:/folder/stochastic.txt")

```

On procède de la même manière pour l'objet d'arguments :


```r
IAM.export(argum,"C:/folder")
```



Le message indique que le slot "specific" commun aux deux objets entraîne un conflit de fichiers. Dans le cas où on veut exporter un objet d'arguments dans le même dossier qu'un objet de paramétrage, il est essentiel que le premier ait été généré par le second, sous peine de détruire la compatibilité des fichiers. Ici, pas de problème puisque argum a été généré à partir de inp. 2 fichiers ont ainsi été créés : "args.txt" et "specific.txt" (un troisième fichier "argsCPP.txt" est également généré, mais il entre dans un cadre spécifique d'utilisation qui sort de notre champ d'application). On recrée l'objet de cette façon :


```r
argum2 <- IAM.args("C:/folder/args.txt",specific="C:/folder/specific.txt")
```

-->
</div>
<div class="section level3">
<h3 id="simulation-iam-model">Simulation (IAM.model)<a class="anchor" aria-label="anchor" href="#simulation-iam-model"></a>
</h3>
<p>Une fois les deux principaux composants du paramétrage obtenus, la mise en route de la simulation est très simple : la méthode <code><a href="../reference/IAM.model-methods.html">IAM.model()</a></code> appelle l’objet de classe <code>iamArgs</code> et l’objet de classe <code>iamInput</code> et restitue les résultats de la simulation dans un objet de classe <code>iamOutput</code>, ou de classe <code>iamOutputRep</code> si le module de réplication est activé.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IAM_out_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.model-methods.html">IAM.model</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span>,<span class="va">IAM_input_2009</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">IAM_out_2009</span><span class="op">)</span>
<span class="co">#&gt; [1] "iamOutput"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "IAM"</span></code></pre></div>
<p>Toutes les sorties du modèle sont entreposées dans 2 slots de l’objet <code>IAM_out_2009</code>. Un slot <code>outputSp</code> réunit toutes les variables définies par espèce modélisée (sorties du modèle biologique principalement), et un autre slot <code>output</code> rassemble les variables sans dimension espèce (les variables économiques). L’accès aux variables est illustré ci-dessous :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slotNames</span><span class="op">(</span><span class="va">IAM_out_2009</span><span class="op">)</span>
<span class="co">#&gt; [1] "desc"      "arguments" "specific"  "outputSp"  "output"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_out_2009</span><span class="op">@</span><span class="va">outputSp</span><span class="op">)</span>
<span class="co">#&gt;   [1] "F"              "Fr"             "Fothi"          "Fbar"          </span>
<span class="co">#&gt;   [5] "Z"              "N"              "B"              "SSB"           </span>
<span class="co">#&gt;   [9] "C"              "Ctot"           "Y"              "Ytot"          </span>
<span class="co">#&gt;  [13] "D"              "Li"             "Lc"             "Ltot"          </span>
<span class="co">#&gt;  [17] "L_et"           "L_pt"           "P"              "GVL_f_m_e"     </span>
<span class="co">#&gt;  [21] "GVLcom_f_m_e"   "GVLst_f_m_e"    "statY"          "statL"         </span>
<span class="co">#&gt;  [25] "statD"          "statP"          "statGVL_f_m"    "statGVLcom_f_m"</span>
<span class="co">#&gt;  [29] "statGVLst_f_m"  "PQuot"          "TradedQ"        "F_S1M1"        </span>
<span class="co">#&gt;  [33] "F_S1M2"         "F_S1M3"         "F_S1M4"         "F_S2M1"        </span>
<span class="co">#&gt;  [37] "F_S2M2"         "F_S2M3"         "F_S2M4"         "F_S3M1"        </span>
<span class="co">#&gt;  [41] "F_S3M2"         "F_S3M3"         "F_S3M4"         "F_S4M1"        </span>
<span class="co">#&gt;  [45] "F_S4M2"         "F_S4M3"         "F_S4M4"         "Fr_S1M1"       </span>
<span class="co">#&gt;  [49] "Fr_S1M2"        "Fr_S1M3"        "Fr_S1M4"        "Fr_S2M1"       </span>
<span class="co">#&gt;  [53] "Fr_S2M2"        "Fr_S2M3"        "Fr_S2M4"        "Fr_S3M1"       </span>
<span class="co">#&gt;  [57] "Fr_S3M2"        "Fr_S3M3"        "Fr_S3M4"        "Fr_S4M1"       </span>
<span class="co">#&gt;  [61] "Fr_S4M2"        "Fr_S4M3"        "Fr_S4M4"        "Z_S1M1"        </span>
<span class="co">#&gt;  [65] "Z_S1M2"         "Z_S1M3"         "Z_S1M4"         "Z_S2M1"        </span>
<span class="co">#&gt;  [69] "Z_S2M2"         "Z_S2M3"         "Z_S2M4"         "Z_S3M1"        </span>
<span class="co">#&gt;  [73] "Z_S3M2"         "Z_S3M3"         "Z_S3M4"         "Z_S4M1"        </span>
<span class="co">#&gt;  [77] "Z_S4M2"         "Z_S4M3"         "Z_S4M4"         "N_S1M1"        </span>
<span class="co">#&gt;  [81] "N_S1M2"         "N_S1M3"         "N_S1M4"         "N_S2M1"        </span>
<span class="co">#&gt;  [85] "N_S2M2"         "N_S2M3"         "N_S2M4"         "N_S3M1"        </span>
<span class="co">#&gt;  [89] "N_S3M2"         "N_S3M3"         "N_S3M4"         "N_S4M1"        </span>
<span class="co">#&gt;  [93] "N_S4M2"         "N_S4M3"         "N_S4M4"         "DD_efmi"       </span>
<span class="co">#&gt;  [97] "DD_efmc"        "LD_efmi"        "LD_efmc"        "statDD_efm"    </span>
<span class="co">#&gt; [101] "statLD_efm"     "statLDst_efm"   "statLDor_efm"   "oqD_ef"        </span>
<span class="co">#&gt; [105] "oqD_e"          "oqDstat_ef"     "TACtot"         "TACbyF"        </span>
<span class="co">#&gt; [109] "PQuot_conv"     "diffLQ_conv"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_out_2009</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>
<span class="co">#&gt;  [1] "nbv_f"              "effort1_f"          "effort2_f"         </span>
<span class="co">#&gt;  [4] "nbv_f_m"            "effort1_f_m"        "effort2_f_m"       </span>
<span class="co">#&gt;  [7] "GVLtot_f_m"         "GVLav_f_m"          "GVLtot_f"          </span>
<span class="co">#&gt; [10] "GVLav_f"            "NGVLav_f_m"         "NGVLav_f"          </span>
<span class="co">#&gt; [13] "ET_f_m"             "cnb_f_m"            "cnb_f"             </span>
<span class="co">#&gt; [16] "rtbs_f_m"           "rtbs_f"             "rtbsAct_f"         </span>
<span class="co">#&gt; [19] "cshrT_f_m"          "cshrT_f"            "ncshr_f"           </span>
<span class="co">#&gt; [22] "ocl_f"              "cs_f"               "csAct_f"           </span>
<span class="co">#&gt; [25] "csTot_f"            "gva_f"              "gvaAct_f"          </span>
<span class="co">#&gt; [28] "gvamargin_f"        "gva_FTE_f"          "ccw_f"             </span>
<span class="co">#&gt; [31] "ccwCr_f"            "wageg_f"            "wagen_f"           </span>
<span class="co">#&gt; [34] "wageg_FTE_f"        "wageg_h_f"          "gp_f"              </span>
<span class="co">#&gt; [37] "gpAct_f"            "gpmargin_f"         "ncf_f"             </span>
<span class="co">#&gt; [40] "np_f"               "npmargin_f"         "prof_f"            </span>
<span class="co">#&gt; [43] "npmargin_trend_f"   "ssTot_f"            "ps_f"              </span>
<span class="co">#&gt; [46] "psAct_f"            "sts_f"              "stsAct_f"          </span>
<span class="co">#&gt; [49] "BER_f"              "CR_BER_f"           "fuelEff_f"         </span>
<span class="co">#&gt; [52] "ratio_fvol_gva_f"   "ratio_gp_gva_f"     "ratio_GVL_K_f"     </span>
<span class="co">#&gt; [55] "ratio_gp_K_f"       "RoFTA_f"            "ROI_f"             </span>
<span class="co">#&gt; [58] "ratio_np_K_f"       "ratio_GVL_cnb_ue_f" "YTOT_fm"           </span>
<span class="co">#&gt; [61] "reconcilSPP"        "quotaExp_f"         "allocEff_f_m"      </span>
<span class="co">#&gt; [64] "GoFish"</span></code></pre></div>
<!-- <details> -->
<!-- TODO : possibilite de collaspe cette partie -->
<p><!-- <summary>`iamOutputRep` simulation</summary> --> Dans le cas d’un objet de classe <code>iamOutputRep</code>, chaque variable est une liste de n éléments, avec n le nombre de réplicats.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Activate replicates</span>
<span class="va">IAM_argumRep_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.editArgs_Rep.html">IAM.editArgs_Rep</a></span><span class="op">(</span><span class="va">IAM_argum_2009</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">IAM_outRep_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.model-methods.html">IAM.model</a></span><span class="op">(</span><span class="va">IAM_argumRep_2009</span>,<span class="va">IAM_input_2009</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">IAM_outRep_2009</span><span class="op">)</span>
<span class="co">#&gt; [1] "iamOutputRep"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "IAM"</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">IAM_outRep_2009</span><span class="op">@</span><span class="va">outputSp</span><span class="op">$</span><span class="cn">F</span><span class="op">)</span>
<span class="co">#&gt; [1] 2</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_outRep_2009</span><span class="op">@</span><span class="va">outputSp</span><span class="op">$</span><span class="cn">F</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "ARC" "COR" "DAR"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">IAM_outRep_2009</span><span class="op">@</span><span class="va">outputSp</span><span class="op">$</span><span class="cn">F</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "ARC" "COR" "DAR"</span></code></pre></div>
<!-- </details>  -->
</div>
<div class="section level3">
<h3 id="mise-en-forme-des-sorties-iam-format-iam-format_quant">Mise en forme des sorties (IAM.format &amp; IAM.format_quant<!--\& IAM.unite -->)<a class="anchor" aria-label="anchor" href="#mise-en-forme-des-sorties-iam-format-iam-format_quant"></a>
</h3>
<p>La méthode IAM.format est une fonction de formatage appliquée aux objets iamOutput <!--et iamOutputRep-->. Elle va permettre la conversion d’une variable multidimensionnelle en une table de type “data.frame” (format facilitant la création de graphiques adaptés à ce type de variables)</p>
<p>Cette fonction prend également en entrée le nom d’une ou plusieurs variables à extraire, un nom de simulation et un numero qui pourront servir plus tard pour aggréger plusieurs simulations ensemble.</p>
<p>On note qu’une variable spéciale nommée <code>"summary"</code> permet d’extraire d’un seul coup quelques variables biologiques et économiques.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extraction d'une variable</span>
<span class="va">statu_quo_tbl_Fbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.format-method.html">IAM.format</a></span><span class="op">(</span><span class="va">IAM_out_2009</span>, name <span class="op">=</span> <span class="st">"Fbar"</span>, 
                                 sim_name <span class="op">=</span> <span class="st">"statu_quo"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">statu_quo_tbl_Fbar</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span>
<span class="co">#&gt;   sim_name      n variable species fleet metier age    year value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> statu_quo     1 Fbar     ARC     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>009 0.122</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> statu_quo     1 Fbar     ARC     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>010 0.122</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> statu_quo     1 Fbar     ARC     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>011 0.122</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> statu_quo     1 Fbar     ARC     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>012 0.122</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> statu_quo     1 Fbar     ARC     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>013 0.122</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> statu_quo     1 Fbar     ARC     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>014 0.122</span>
<span class="co"># Extraction de plusieurs variables</span>
<span class="va">statu_quo_tbl_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.format-method.html">IAM.format</a></span><span class="op">(</span><span class="va">IAM_out_2009</span>, name <span class="op">=</span> <span class="st">"summary"</span>, 
                                    sim_name <span class="op">=</span> <span class="st">"statu_quo"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">statu_quo_tbl_summary</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Fbar"      "SSB"       "L_et"      "N"         "nbv_f"     "effort1_f"</span>
<span class="co">#&gt;  [7] "effort2_f" "GVLav_f"   "gva_f"     "gp_f"      "wageg_f"   "wagen_f"</span></code></pre></div>
<!--

-->
<p>Ce format de table long permet ensuite l’utilisation d’outils pour trier et éventuellement produire les tables dans un format large.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'magrittr'</span>
<span class="co">#&gt; The following object is masked from 'package:purrr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     set_names</span>
<span class="co">#&gt; The following object is masked from 'package:tidyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     extract</span>

<span class="co"># Extraction du SSB</span>
<span class="va">statu_quo_tbl_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"COR"</span>, <span class="va">variable</span> <span class="op">==</span> <span class="st">"SSB"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># trie des lignes</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># retire les colonnes vides (NA)</span>
  <span class="co"># Ligne optionnelle pour enlever les colonnes identiques.</span>
  <span class="co"># discard( ~ n_distinct(.) == 1) %&gt;% </span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">year</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="co"># mise en forme horizontale</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 16</span></span>
<span class="co">#&gt;   sim_name      n variable species `2009` `2010` `2011` `2012` `2013` `2014`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> statu_quo     1 SSB      COR     <span style="text-decoration: underline;">10</span>426. <span style="text-decoration: underline;">11</span>347. <span style="text-decoration: underline;">12</span>051. <span style="text-decoration: underline;">12</span>523. <span style="text-decoration: underline;">12</span>820. <span style="text-decoration: underline;">13</span>033.</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 6 more variables: `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   `2018` &lt;dbl&gt;, `2019` &lt;dbl&gt;, `2020` &lt;dbl&gt;</span></span>


<span class="co"># Table de gp_f</span>
<span class="va">statu_quo_tbl_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"gp_f"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># trie des lignes</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># retire les colonnes vides (NA)</span>
  <span class="co"># Ligne optionnelle pour enlever les colonnes identiques.</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">year</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="co"># mise en forme horizontale</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 13</span></span>
<span class="co">#&gt;   fleet   `2009`  `2010`  `2011`  `2012`  `2013`  `2014`  `2015`  `2016`  `2017`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Alis   -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.10</span><span style="color: #949494;">e</span>7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Antea  -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">4.75</span><span style="color: #949494;">e</span>7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Atala… -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.18</span><span style="color: #949494;">e</span>7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Halio… -<span style="color: #BB0000;">6.83</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.86</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.92</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.92</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.87</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.72</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.54</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.38</span><span style="color: #949494;">e</span>5 -<span style="color: #BB0000;">6.24</span><span style="color: #949494;">e</span>5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Mario… -<span style="color: #BB0000;">6.24</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.26</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.25</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.23</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.23</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.24</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.24</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.25</span><span style="color: #949494;">e</span>6 -<span style="color: #BB0000;">6.25</span><span style="color: #949494;">e</span>6</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Pourq… -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">1.66</span><span style="color: #949494;">e</span>7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Thala… -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.21</span><span style="color: #949494;">e</span>7 -<span style="color: #BB0000;">3.20</span><span style="color: #949494;">e</span>7</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 3 more variables: `2018` &lt;dbl&gt;, `2019` &lt;dbl&gt;, `2020` &lt;dbl&gt;</span></span></code></pre></div>
<p>Dans le cas d’une liste d’objet de classe <code>iamOuput</code>, il est possible d’extraire les variables, de concaténer et d’ensuite calculer une table résumée ne présentant que les quantiles d’interêt. Cela permet d’alleger les sorties du modèle et de les manipuler plus simplement lors de la production de représentations graphiques.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.format-method.html">IAM.format</a></span><span class="op">(</span><span class="va">IAM_out_2009</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSB"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"ARC"</span>, <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2011</span><span class="op">)</span>
<span class="co"># Je modifie légérement les données pour avoir des quantiles écartés.</span>
<span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">res1</span>, n <span class="op">=</span> <span class="fl">2</span>, value <span class="op">=</span> <span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>

<span class="co"># On peut associer les données extraites avec rbind.</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">res1</span>, <span class="va">res2</span><span class="op">)</span>

<span class="fu"><a href="../reference/IAM.format_quant.html">IAM.format_quant</a></span><span class="op">(</span><span class="va">res</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, select_indiv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span>
<span class="co">#&gt;   variable species  year quant1 quant2 median  value  nsim</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> SSB      ARC      <span style="text-decoration: underline;">2</span>009 <span style="text-decoration: underline;">18</span>577. <span style="text-decoration: underline;">18</span>719. <span style="text-decoration: underline;">18</span>648. <span style="text-decoration: underline;">18</span>574.     2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> SSB      ARC      <span style="text-decoration: underline;">2</span>010 <span style="text-decoration: underline;">17</span>845. <span style="text-decoration: underline;">17</span>986. <span style="text-decoration: underline;">17</span>916. <span style="text-decoration: underline;">17</span>841.     2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> SSB      ARC      <span style="text-decoration: underline;">2</span>011 <span style="text-decoration: underline;">17</span>074. <span style="text-decoration: underline;">17</span>216. <span style="text-decoration: underline;">17</span>145. <span style="text-decoration: underline;">17</span>071.     2</span></code></pre></div>
<p>A noter que des colonnes seront souvent remplies de valeurs manquantes car peu de variables sont définies sur toutes les dimensions d’IAM. Cependant, il vaut mieux conserver ces colonnes jusqu’au dernier moment afin de pouvoir trier les données avec des fonctions génériques ou encore pouvoir utiliser <code>rbind</code>.</p>
</div>
<div class="section level3">
<h3 id="représentations-graphiques-des-sorties-avec-ggplot2">Représentations graphiques des sorties avec ggplot2<a class="anchor" aria-label="anchor" href="#repr%C3%A9sentations-graphiques-des-sorties-avec-ggplot2"></a>
</h3>
<p>Les procédures graphiques ont été retirées du packages et se basent sur l’utilisation du package ggplot2. Ainsi, le format de table renvoyé par les fonctions IAM.format et IAM.format_quant sera requis pour constiturer la donnée à représenter.</p>
<p>Pour illustrer différentes représentations graphiques, on va générer plusieurs réplicats. Le premier sera similaire le cas de <em>statu quo</em> généré plus haut. On modifie le module de recrutement pour l’espèce “COR” afin d’ajouter un peu d’effets stochastiques. Un second scénario est simulé avec l’application de quotas. Le détails de ce genre de simulations est donné dans la vignette “Gestion_TAC”.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">=</span> <span class="fl">5</span>

<span class="co"># Add noise to COR recruitment</span>
<span class="va">IAM_argum_2009</span><span class="op">@</span><span class="va">arguments</span><span class="op">$</span><span class="va">Recruitment</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">wnNOISEmodSR</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">IAM_argum_2009</span><span class="op">@</span><span class="va">arguments</span><span class="op">$</span><span class="va">Recruitment</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">noiseTypeSR</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Log-normal</span>
<span class="va">IAM_argum_2009</span><span class="op">@</span><span class="va">arguments</span><span class="op">$</span><span class="va">Recruitment</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">typeMODsr</span> <span class="op">&lt;-</span> <span class="st">"Hockey-Stick"</span>
<span class="va">IAM_argum_2009</span><span class="op">@</span><span class="va">arguments</span><span class="op">$</span><span class="va">Recruitment</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">parAmodSR</span> <span class="op">&lt;-</span> <span class="fl">2600</span>
<span class="va">IAM_argum_2009</span><span class="op">@</span><span class="va">arguments</span><span class="op">$</span><span class="va">Recruitment</span><span class="op">$</span><span class="va">COR</span><span class="op">$</span><span class="va">parBmodSR</span> <span class="op">&lt;-</span> <span class="fl">9700</span>

<span class="co"># Simulation</span>
<span class="va">sim_statu_quo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="op">{</span>
  <span class="fu">IAM</span><span class="fu">::</span><span class="fu"><a href="../reference/IAM.model-methods.html">IAM.model</a></span><span class="op">(</span>objArgs <span class="op">=</span> <span class="va">IAM_argum_2009</span>,  objInput <span class="op">=</span> <span class="va">IAM_input_2009</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="co"># Edition des arguments</span>
<span class="va">IAM_argum_2009_TACnbv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IAM.editArgs_Gest.html">IAM.editArgs_Gest</a></span><span class="op">(</span>
  <span class="va">IAM_argum_2009</span>, active <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="st">"Nb vessels"</span>, target <span class="op">=</span> <span class="st">"TAC"</span>,
  espece <span class="op">=</span> <span class="st">"COR"</span>, delay <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"x"</span>, bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e7</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, 
  tac <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3400</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Simulation</span>
<span class="va">sim_TACglob_nbv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="op">{</span>
  <span class="fu">IAM</span><span class="fu">::</span><span class="fu"><a href="../reference/IAM.model-methods.html">IAM.model</a></span><span class="op">(</span>objArgs <span class="op">=</span> <span class="va">IAM_argum_2009_TACnbv</span>,  
                 objInput <span class="op">=</span> <span class="va">IAM_input_2009</span>, mOTH <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="co"># Formatage</span>
<span class="va">TACglobv_nbv_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/IAM.format-method.html">IAM.format</a></span><span class="op">(</span><span class="va">sim_TACglob_nbv</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, name <span class="op">=</span> <span class="st">"summary"</span>, 
             sim_name <span class="op">=</span> <span class="st">"TAC global nbv"</span>, n <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">Statuquo_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/IAM.format-method.html">IAM.format</a></span><span class="op">(</span><span class="va">sim_statu_quo</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, name <span class="op">=</span> <span class="st">"summary"</span>, 
             sim_name <span class="op">=</span> <span class="st">"Statu quo"</span>, n <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="va">TACvsSQ_5simuls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Statuquo_l</span>, <span class="va">TACglobv_nbv_l</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/IAM.format_quant.html">IAM.format_quant</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">.975</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!--
Les procédures graphiques intégrées au package héritent des méthodes de représentation de données multivariées du package "lattice". Ainsi, le format de table renvoyé par les fonctions IAM.format et IAM.unite sera requis pour constituer la donnée à représenter, et les formulations seront similaires à celles utilisées de le cadre d'application des fonctions "lattice" (voir xyplot).
Pour illustrer ceci, deux jeux de données exemples ont été mis à disposition de l'utilisateur du package : une sortie formatée sans réplicats, et une sortie formatée avec réplicats, dont voici un aperçu :


```r
 #on charge la donnée
data(iamData)
ls()
DFiam
tail(DFiam_iter)
```

NB : les deux tables sont des sorties de la fonction IAM.unite, de paramètre headers égal à "a\_c" pour DFiam, et égal à "Scen" pour DFiam\_iter.
Les paramètres graphiques sont listés dans la feuille d'aide des fonctions graphiques, que l'on peut afficher en tapant :


```r
?IAM.plot
```

-->
<p>Pour les sorties graphiques on aura besoin du package ggplot2. Cette dépendance est normalement installée en même temps que le package IAM. Ce package est très riche en terme de représentations graphiques, on pourra se référer à sa documentation pour plus de précisions.Un site repertorie également de nombreux exemples : <a href="https://r-graph-gallery.com/" class="external-link">https://r-graph-gallery.com/</a>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span> <span class="co"># utilisation du pipe %&gt;%</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># utilisation de filtres</span></code></pre></div>
<p>Voici quelques exemples de représentations graphiques disponibles pour les sortie d’IAM :</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TACvsSQ_5simuls</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># Filtrer de l'espece et de la variable cible</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"COR"</span>, <span class="va">variable</span> <span class="op">==</span> <span class="st">"Fbar"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">sim_name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">quant1</span>, ymax <span class="op">=</span> <span class="va">quant2</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/IAM_theme.html">IAM_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="cn">NULL</span></code></pre></div>
<div class="figure">
<img src="use_IAM_files/figure-html/plotdiffscenar-1.png" alt="\label{fig:figs}Evolution du Fbar dans le cas de l'espèce COR. 5 runs." width="672"><p class="caption">
Evolution du Fbar dans le cas de l’espèce COR. 5 runs.
</p>
</div>
<p>L’exemple précédent permet d’illustrer la comparaison du Fbar pour deux scénarios et une espèce donnée (“COR”). On peut observer l’enveloppe à droite qui est représente les deux quartiles entre lesquels on retrouve 95% des simulations.</p>
<p>On peut également représenter plusieurs variables comme ci-dessous les variables biologiques de l’espèce COR :</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TACvsSQ_5simuls</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"COR"</span>, <span class="va">variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fbar"</span>, <span class="st">"SSB"</span>, <span class="st">"L_et"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">~</span> <span class="va">sim_name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">quant1</span>, ymax <span class="op">=</span> <span class="va">quant2</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/IAM_theme.html">IAM_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
 <span class="cn">NULL</span></code></pre></div>
<div class="figure">
<img src="use_IAM_files/figure-html/plotdiffvar-1.png" alt="\label{fig:figs}Evolution des variables biologiques dans le cas de l'espèce COR. 5 runs." width="672"><p class="caption">
Evolution des variables biologiques dans le cas de l’espèce COR. 5 runs.
</p>
</div>
<p>Enfin, on peut tout à fait intégrer plus de dimensions aux graphiques avec l’ajout de couleurs pour par exemple ici comparer deux scénarios par Flottilles et variables économiques :</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TACvsSQ_5simuls</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GVLav_f"</span>, <span class="st">"nbv_f"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">sim_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">~</span> <span class="va">fleet</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">quant1</span>, ymax <span class="op">=</span> <span class="va">quant2</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/IAM_theme.html">IAM_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"darkorange"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
 <span class="cn">NULL</span></code></pre></div>
<div class="figure">
<img src="use_IAM_files/figure-html/plotdifffleet-1.png" alt="\label{fig:figs}Evolution des variables économiques pour les flottilles modélisées. 5 runs." width="672"><p class="caption">
Evolution des variables économiques pour les flottilles modélisées. 5 runs.
</p>
</div>
<!--
On notera que ces paramètres sont similaires à ceux utilisés dans les fonctions graphiques du package "lattice" : on pourra se référer à la documentation de ce dernier pour plus de précisions.

Il existe pour le moment 5 fonctions graphiques permettant de retranscrire les sorties du modèle : 2 pour les données sans variabilité issues d'objets de classe iamOutput (IAM.plot et IAM.barplot), et 3 pour les données avec itérations multiples (de classe iamOutputRep), permettant d'illustrer la variabilité de ces résultats (IAM.barIC, IAM.bwplot et IAM.zone). Voici quelques exemples d'applications possibles :



```r
IAM.barplot(un+deux+trois+quatre+cinq+gp\simt, data=DFiam, txt.leg=c("1yr","2yrs","3yrs","4yrs","5yrs","6yrs"), origin=0)
```



```r
# on définit deux jeux de couleurs, le premier étant la version ”translucide” du second
col1 <- c(rgb(t(col2rgb("#E68F6A")/255),alpha=0.7), rgb(t(col2rgb("#35A2F2")/255),alpha=0.2))
col2 <- c("red","#35A2F2")
IAM.bwplot(SQ + Scenario \sim t | f, data=DFiam_iter, col=col2, fill=col1,
           rot.x=90, cex.axis.x=0.7, cex.axis.y=0.8, cex.pch=0.3, pch=15,
           txt.leg=c("Statu Quo","Scenario"), xlab="Year", ylab="Value", add.h=0)

```


L'exemple précédent permet de comprendre la formulation faisant office de paramètre principal. Cette formule permet de distinguer les variables qui seront illustrées au sein de chaque graphique (intra), des variables qui caractériseront chaque graphique (inter). La première partie de la formule (à gauche du \sim) regroupe la ou les variables qui seront représentées en ordonnée (autrement dit les quantités, ici par scénario). C'est ici qu'on énumère les variables "intra", en les séparant d'un signe "+". Les variables "intra" seront le plus souvent les modalités de la dimension choisie en tant que paramètre headers de la fonction de formatage des sorties (voir partie 3.2.6). A droite du signe \sim doit être spécifiée la variable représentée en abscisse (ici, le temps). Si nécessaire, une déclinaison "inter" peut être définie en ajoutant un séparateur "|", et en énumérant les variables caractérisant chacun des graphiques (si on considère plusieurs champs de déclinaison, ils devront être séparés par "*"). Dans notre exemple, on a bien un graphique pour chaque flottille modélisée.



```r
IAM.zone(SQ + Scenario \sim t | f, data=DFiam_iter, col=col2,
         rot.x=90, cex.axis.x=0.7, cex.axis.y=0.8, cex.pch=0.3, pch=15,
         txt.leg=c("Statu Quo","Scenario"), xlab="Year", ylab="Value", alpha=0.2)
```


Une troisième manière de présenter des variabilités est d'afficher des barres de valeurs moyennes assorties d'intervalles de confiance.



```r
IAM.barIC(SQ + Scenario \sim t | f, data=subset(DFiam_iter,t%in%(2010:2015)),
     col=col2, rot.x=90, cex.axis.x=0.7, cex.axis.y=0.8, txt.leg=c("Statu Quo","Scenario"),
     xlab="Year", ylab="Value", origin=0)
```


L'exemple suivant montre l'application de la fonction IAM.plot à une donnée iamOutputRep réduite à une seule itération, et illustre comment modifier le graphe au même titre que n'importe quel graphique lattice de base, grâce à la fonction update.


```r
IAM.plot(SQ + Scenario \sim t | f, data=subset(DFiam_iter, iter==1),
            col=col2, rot.x=90, cex.axis.x=0.7, cex.axis.y=0.8, cex.pch=0.3, pch=15,
            txt.leg=c("Statu Quo","Scenario"), xlab="Year", ylab="Value", add.h=0, add.lty=2)
update(trellis.last.object(), scales=list(alternating=1))
```

La fonction update ciblant la sortie graphique va permettre d'appliquer des paramètres "lattice" qui n'auraient pas été considérés dans l'implémentation des fonctions graphiques du package "IAM".

-->
</div>
</div>
<div class="section level2">
<h2 id="conseil-de-réplication">Conseil de réplication<a class="anchor" aria-label="anchor" href="#conseil-de-r%C3%A9plication"></a>
</h2>
<p>L’utilisation du package IAM prend tout son sens lors du lancement d’un même scénario répliqué de nombreuses fois. Cela permet de prendre en compte les problématiques stochastiques de certaines variables comme le recrutement. Ainsi, un même scénario peut être lancé plusieurs centaines de fois. Cette option est implémentée de base dans le package avec la classe <code>IAMOutputRep</code>, mais celle-ci est dépcréciée car ne permettant plus la réalisation de scénarios complexes.</p>
<p>Une autre alternative réside dans l’utilisation de code R pour forcer de grands nombres de réplicats, au détriment d’une plus grande place en mémoire. Notons tout de même que cela peut prendre un certain temps.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Code non exécuté</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.ifremer.fr/iam/iam" class="external-link">IAM</a></span><span class="op">)</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># mesure du temps</span>
<span class="va">nsim_statu_quo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span>
  <span class="fl">500</span>,
  <span class="fu">IAM</span><span class="fu">::</span><span class="fu"><a href="../reference/IAM.model-methods.html">IAM.model</a></span><span class="op">(</span>objArgs <span class="op">=</span> <span class="va">IAM_argum_2009</span>, objInput <span class="op">=</span> <span class="va">IAM_input_2009</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># mesure du temps</span>
<span class="va">b</span> <span class="op">-</span> <span class="va">a</span> <span class="co"># 1.17 min</span></code></pre></div>
<p>Afin de gagner du temps, le package <code>{parallel}</code> permet d’effectuer les calculs sur un plus grand nombre de processeurs de l’ordinateurs. L’utilisation de ce package permet de réduire le temps de calcul pour un grand nombre de réplicats et est donc conseillé.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Code non exécuté</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>,<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.ifremer.fr/iam/iam" class="external-link">IAM</a></span><span class="op">)</span><span class="op">)</span> <span class="co"># charger les librairies dans le cluster.</span>

<span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># mesure du temps</span>
<span class="co"># rendre les objets disponibles pour le code</span>
<span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IAM_argum_2009"</span>, <span class="st">"IAM_input_2009"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># S'assurer de "seed" différentes pour chaque noeud.</span>
<span class="fu"><a href="https://rdrr.io/r/parallel/RngStream.html" class="external-link">clusterSetRNGStream</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>
<span class="co">#... Simuler les réplicats ...</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parSapply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span>,<span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">IAM</span><span class="fu">::</span><span class="fu"><a href="../reference/IAM.model-methods.html">IAM.model</a></span><span class="op">(</span>objArgs <span class="op">=</span> <span class="va">IAM_argum_2009</span>, objInput <span class="op">=</span> <span class="va">IAM_input_2009</span><span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="co"># Arreter le cluster</span>
<span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># mesure du temps</span>
<span class="va">d</span> <span class="op">-</span> <span class="va">c</span> <span class="co"># 51 sec !!!</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs">
<div id="ref-R-base">
<p>R Core Team. 2021. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://gowachin.github.io/" class="external-link">Maxime Jaunatre</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
